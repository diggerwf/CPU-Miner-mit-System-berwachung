#!/bin/bash

# Update und Upgrade des Systems
sudo apt update && sudo apt full-upgrade -y

# Nicht mehr benötigte Pakete entfernen
sudo apt autoremove -y

# Notwendige Pakete installieren
sudo apt install git automake autoconf libcurl4-openssl-dev libjansson-dev libssl-dev libgmp-dev zlib1g-dev screen build-essential mosquitto-clients -y

# Repository klonen
git clone https://github.com/tpruvot/cpuminer-multi
cd cpuminer-multi

# Autogen-Skript ausführen, konfigurieren und bauen
sudo ./autogen.sh
sudo ./configure
sudo ./build.sh

# Miner in einer Screen-Session starten
screen -dmS btc-miner ./cpuminer -a sha256d -o stratum+tcp://public-pool.io:21496 -u 3QyGiLdn9rvP6DKnT5qkYRSuodiRB2VEXi -p x

# Netdata installieren (ohne Wartezeit)
bash <(curl -SsL https://my-netdata.io/kickstart.sh) --dont-wait

echo "Installation abgeschlossen. Der Miner läuft in der Screen-Session 'btc-miner'."
